package pro.documentum.util.crypto;

import static junit.framework.TestCase.assertNotNull;

import org.junit.Ignore;
import org.junit.Test;

/**
 * @author Andrey B. Panfilov <andrey@panfilov.tel>
 */
public class AEKUtilTest {

    public static final byte[] AES256 = new byte[] {0x02, 0x00, 0x00, 0x00,
        0x1c, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x58, 0x00, 0x00, 0x00,
        0x03, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x10,
        (byte) 0xb4, (byte) 0xf2, (byte) 0xe8, 0x43, 0x29, (byte) 0xd1, 0x01,
        0x38, (byte) 0x85, (byte) 0xad, (byte) 0xd0, 0x34, (byte) 0x94,
        (byte) 0xfa, (byte) 0xa1, (byte) 0xb7, 0x01, 0x00, 0x00, 0x00, 0x28,
        0x00, 0x00, 0x00, 0x30, 0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x20,
        0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x08,
        0x00, 0x00, 0x00, (byte) 0xe2, (byte) 0xb9, 0x26, 0x11, 0x12,
        (byte) 0xef, (byte) 0xf4, 0x57, 0x31, (byte) 0xdb, (byte) 0xae, 0x67,
        (byte) 0xeb, (byte) 0xd2, (byte) 0x94, 0x3d, 0x75, 0x71, (byte) 0xfa,
        0x5b, (byte) 0xa5, 0x16, (byte) 0xdf, 0x42, 0x41, (byte) 0x88, 0x7e,
        0x39, 0x08, 0x1f, 0x14, (byte) 0xdd, 0x30, 0x68, (byte) 0x8f, 0x65,
        0x01, (byte) 0xd4, (byte) 0x82, 0x5b, 0x32, (byte) 0xc3, 0x0c,
        (byte) 0xf6, (byte) 0xd4, (byte) 0xa7, 0x58, (byte) 0xe9, 0x55,
        (byte) 0xee, (byte) 0x82, (byte) 0xc9, 0x2d, 0x6a, 0x0b, 0x0b, };

    public static final byte[] DES3 = new byte[] {0x01, 0x00, 0x00, 0x00, 0x1c,
        0x00, 0x00, 0x00, 0x03, 0x00, 0x00, 0x00, 0x50, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x00, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x28, 0x00, 0x00, 0x00, 0x01,
        0x00, 0x00, 0x00, 0x18, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x00,
        0x04, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x37, (byte) 0xed, 0x48,
        (byte) 0xa5, 0x5c, (byte) 0xc5, (byte) 0xce, (byte) 0xbe, (byte) 0xb9,
        0x5f, 0x5e, 0x2b, (byte) 0x97, (byte) 0xb3, 0x11, (byte) 0x95,
        (byte) 0xbd, 0x0e, (byte) 0xf4, 0x2b, 0x78, (byte) 0xd2, (byte) 0xe2,
        0x39, 0x18, (byte) 0x9e, (byte) 0x92, (byte) 0xf9, (byte) 0xb4,
        (byte) 0xd8, 0x11, 0x6b, 0x02, 0x55, (byte) 0xcc, 0x55, (byte) 0x86,
        (byte) 0x99, 0x03, 0x77, (byte) 0xb1, 0x25, 0x50, (byte) 0xf9,
        (byte) 0xae, 0x50, (byte) 0xef, 0x76, };

    @Test
    @Ignore("requires java unrestricted policy files")
    public void testAES256() throws Exception {
        AEKUtil aekUtil = AEKUtil.getInstance(AES256);
        assertNotNull(aekUtil.getKey());
    }

    @Test
    public void testDES3() throws Exception {
        AEKUtil aekUtil = AEKUtil.getInstance(DES3);
        assertNotNull(aekUtil.getKey());
    }

}
